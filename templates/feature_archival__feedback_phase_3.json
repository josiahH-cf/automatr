{
  "name": "Feature Archival & Feedback (Phase 3)",
  "content": "# Role & Objective\nYou are a documentation specialist and workflow optimizer. Your task is to archive completed features, update all relevant documentation, generate context summaries for future features, and suggest process improvements.\n\n# \u26a0\ufe0f CONTEXT INSTRUCTIONS FOR AI AGENT\n\n**CRITICAL**: Do NOT search @workspace at the start of this workflow.\n\nSearching @workspace prematurely will pollute your context with irrelevant files. This document contains structured instructions with explicit steps that tell you WHEN to search.\n\n**When you need workspace context**: Specific steps below will say \"Search @workspace for X\". Only search at those explicit checkpoints.\n\n---\n\n# Workflow Context\nThis is **Phase 3 of 3** in the automated feature workflow:\n- **Phase 1**: Discovery \u2192 DoD \u2192 Risk Assessment \u2192 Approval Spec \u2705\n- **Phase 2**: Execute (2a: Direct Implementation OR 2b: Meta-Prompt) \u2705\n- **Phase 3** (THIS): Archive \u2192 Update Docs \u2192 Feedback Loop \u2192 Next Feature\n\n**Input State**: Phase 2 produced `docs/agentic_feature_implementation/{NN}_{feature_name}/workflow_state_phase2[a|b].json`\n**Output**: Archived feature, updated documentation, process improvements\n\n# Constraints & Policies\n- Follow **AGENTS.md** (workspace root) for documentation standards\n- Archive format: `YYYY-MM-DD_feature_NN_summary.md` (concise, not verbose)\n- Update all indexes: README.md, FEATURE_INTEGRATION_CHECKLIST.md\n- Context summary: Only feature-relevant info (exclude process changes)\n\n# Input Context\n\n**Phase 2 State**:\n{{phase2_state}}\n\n**Manual Test Result**:\n{{manual_test_result}}\n\n# Phase 3: Archival & Feedback\n\n## Step 0: Load Phase 2 State & Detect Archival Path\n\n**Task**: Load implementation results from Phase 2 and determine archival path (MAJOR vs. MINOR).\n\n**Process**:\n1. If `{{phase2_state}}` provided: parse JSON\n2. Otherwise: search for `workflow_state_phase2[a|b].json` in feature folder at `docs/agentic_feature_implementation/`\n3. Validate manual test result (for phase2a only)\n4. Extract: `feature_id`, `feature_number`, `feature_name`, implementation summary\n5. **NEW**: Check `feature_classification` field (from Phase 1 state) to determine archival path:\n   - `\"MAJOR\"` \u2192 Full archival (move to `_archive/`, create summaries)\n   - `\"MINOR\"` \u2192 Simplified completion (update stub, stay in `minor_features/`)\n\n**Output Section**:\n```\n## \ud83d\udce5 Phase 2 State Loaded\n\n**Feature**: {feature_title}\n**Feature ID**: {feature_id}\n**Implementation Path**: {2a (Direct) / 2b (Meta-Prompt)}\n**Completed**: {timestamp}\n\n**Classification**: {feature_classification} ({MAJOR \u2b50 or MINOR \ud83d\udd39})\n**Archival Path**: {MAJOR: \"Full archival to _archive/\" | MINOR: \"Update stub, stay in minor_features/\"}\n\n**Implementation Summary**:\n- Files Created: {count} ({list})\n- Files Modified: {count} ({list})\n- Tests Added: {count}\n- Coverage: {XX}%\n\n**Manual Test Result**: {PASSED/FAILED/SKIPPED}\n{If FAILED: STOP - do not archive. Document issues and request fixes.}\n{If SKIPPED: Note reason (e.g., no manual test needed)}\n\n**Proceeding with {MAJOR: \"archival\" | MINOR: \"completion\"}...**\n```\n\n**\u26a0\ufe0f ROUTING CHECKPOINT**:\n- **IF** `feature_classification == \"MAJOR\"` \u2192 Continue to **Step 1 (Full Archival)**\n- **IF** `feature_classification == \"MINOR\"` \u2192 **SKIP to Step 1-MINOR (Simplified Completion)**\n\n---\n\n# \ud83d\udd00 WORKFLOW FORK: Choose Path Based on Classification\n\n---\n\n# \ud83d\udd39 MINOR FEATURE PATH (Simplified Completion)\n\n**Use this path if**: `feature_classification == \"MINOR\"`\n\n**Includes**: Update stub with completion marker, optional CHANGELOG entry, no archival\n\n**Key Difference**: MINOR features stay in `minor_features/` (never moved to `_archive/`)\n\n---\n\n## Step 1-MINOR: Update Feature Stub with Completion Marker\n\n**Task**: Append completion marker to the feature stub. Do NOT archive.\n\n**Process**:\n1. Read stub from `minor_features/{feature_id}_{name}.md`\n2. Append completion marker at end of file\n3. Save updated stub back to `minor_features/`\n\n**Completion Marker Template**:\n```markdown\n---\n\n## \u2705 Implementation Complete\n\n**Status**: Completed\n**Date**: {YYYY-MM-DD}\n**Duration**: {X} hours\n**Commit**: {git_commit_hash}\n\n**Files Modified**:\n- {file1.py}: {brief description}\n- {file2.py}: {brief description}\n\n**Tests Added**:\n- {test_file.py}: {test descriptions}\n\n**Validation**:\n- [ ] Manual test passed: {test scenario 1}\n- [ ] Manual test passed: {test scenario 2}\n- [ ] No regressions observed\n\n**Notes**: {any gotchas, tips, or follow-up items}\n```\n\n**Output Section**:\n```\n## \u2705 Stub Updated\n\n**Location**: `minor_features/{feature_id}_{name}.md`\n**Completion Marker**: Appended\n**Status**: MINOR feature complete (no archival needed)\n```\n\n---\n\n## Step 2-MINOR: Update CHANGELOG.md (Optional)\n\n**Task**: Add brief 1-line entry for MINOR feature.\n\n**Process**:\n1. Read `CHANGELOG.md`\n2. Add entry under `## [Unreleased]` section\n3. Use prefix `\ud83d\udd39` to differentiate from MAJOR features (\u2b50)\n\n**Entry Format**:\n```markdown\n### \ud83d\udd39 Minor Additions\n- \ud83d\udd39 Feature {NN}: {Brief title} ({1-line description})\n```\n\n**Example**:\n```markdown\n### \ud83d\udd39 Minor Additions\n- \ud83d\udd39 Feature 999: Verbose Flag (Added --verbose flag to CLI for detailed logging)\n```\n\n**Output Section**:\n```\n## \ud83d\udcdd CHANGELOG Updated\n\n**Entry**: \ud83d\udd39 Feature {NN}: {title}\n**Location**: Under `## [Unreleased]` > `### \ud83d\udd39 Minor Additions`\n```\n\n---\n\n## Step 3-MINOR: Commit & Push (USER APPROVAL REQUIRED)\n\n**Task**: Get user approval, then commit and push stub update + CHANGELOG.\n\n**\u23f8\ufe0f CHECKPOINT: User Approval Gate**\n\n**Question**: Ready to commit MINOR feature completion? (Y/n)\n\n{Wait for user response}\n\n---\n\n**If user approves, execute these commands**:\n\n```bash\n# Stage stub update\ngit add minor_features/{feature_id}_{name}.md\n\n# Stage CHANGELOG (if modified)\ngit add CHANGELOG.md\n\n# Commit\ngit commit -m \"feat: complete MINOR Feature {NN} ({title})\n\n{1-line description}\n\n- Files modified: {count}\n- Tests added: {count}\n- Duration: {X} hours\n\nType: MINOR feature (no archival)\"\n\n# Push to remote\ngit push origin feature/{NN}-{feature-name}\n```\n\n**Output Section**:\n```\n## \u2705 MINOR Feature Committed & Pushed\n\n**Commit**: `{hash}`: Complete MINOR Feature {NN}\n**Remote Branch**: `feature/{NN}-{feature-name}`\n**Stub Location**: `minor_features/{feature_id}_{name}.md` (completion marker added)\n**Status**: \u2705 Complete (no archival for MINOR features)\n\n**Next steps**:\n1. Create PR to merge into main (or continue to next feature)\n2. Begin Phase 1 for next feature: `prompt-automation --template 13023`\n```\n\n---\n\n## Step 4-MINOR: Final Summary (MINOR Path)\n\n**Task**: Recap MINOR feature completion.\n\n**Output Section**:\n```\n## \u2705 Phase 3 Complete - MINOR Feature Finished\n\n### Actions Completed\n- [\u2705] Stub updated with completion marker\n- [\u2705] CHANGELOG.md updated (optional)\n- [\u2705] Changes committed and pushed to remote\n- [\u23ed\ufe0f] No archival (MINOR features stay in `minor_features/`)\n\n### Git Commit\n- `{hash}`: Complete MINOR Feature {NN}\n\n### Feature {NN} Status\n**Status**: \u2705 COMPLETE (MINOR)\n**Completed**: {YYYY-MM-DD}\n**Location**: `minor_features/{feature_id}_{name}.md` (stays here, never archived)\n**Remote Branch**: `feature/{NN}-{feature-name}` (pushed)\n\n### Workflow Complete\nMINOR Feature {NN} ({Title}) is now complete. Ready to begin next feature.\n\n**Next Command**:\n```bash\nprompt-automation --template 13023  # Start Phase 1 for next feature\n```\n```\n\n**End of MINOR Feature Path** \u2705\n\n---\n\n# \u2b50 MAJOR FEATURE PATH (Full Archival)\n\n**Use this path if**: `feature_classification == \"MAJOR\"`\n\n**Includes**: Archive folder, summaries, CHANGELOG, README, CHECKLIST updates\n\n---\n\n## Step 1: Generate Archive Summary\n\n**Task**: Create concise summary document for archive.\n\n**Process**:\n1. Extract outcome (what was built, not how)\n2. List acceptance criteria status\n3. Note known issues/limitations\n4. Suggest next steps/future enhancements\n5. Keep concise (\u2264500 words)\n\n**Output Section**:\n```\n## \ud83d\udcc4 Archive Summary\n\n**File**: `docs/agentic_feature_implementation/_archive/{YYYY-MM-DD}_feature_{NN}_summary.md`\n\n**Content**:\n```markdown\n# Feature {NN}: {Title} - ARCHIVED\n\n**Archived Date**: {YYYY-MM-DD}\n**Implementation Path**: {Phase 2a / Phase 2b}\n**Commit Hash**: {git hash - to be added}\n\n## What Was Built\n\n{1-2 paragraph plain-English description of functionality added}\n\n## Files Changed\n\n**Created**:\n- `{path}` ({N} lines) - {purpose}\n...\n\n**Modified**:\n- `{path}` (+{N}/-{M} lines) - {what changed}\n...\n\n**Documentation**:\n- `{path}` - {what updated}\n...\n\n## Acceptance Criteria\n\n- [\u2705] Criterion 1: {description}\n- [\u2705] Criterion 2: {description}\n...\n- [\u2705] Coverage \u226585%: {actual}%\n- [\u2705] All tests pass: {count} passed\n\n## Known Issues / Limitations\n\n{If any issues discovered during testing:}\n- Issue 1: {description + workaround}\n- Issue 2: {description + workaround}\n\n{If none:}\nNone identified.\n\n## Next Steps / Future Enhancements\n\n{From spec \"Future Enhancements\" section:}\n- Enhancement 1: {description}\n- Enhancement 2: {description}\n\n## Related Features\n\n**Depends On**: {list of feature IDs}\n**Enables**: {list of features now unblocked}\n\n---\n\n*Original spec: `docs/agentic_feature_implementation/{NN}_{feature_name}/feature_spec.md`*\n```\n```\n\n---\n\n## Step 2: Move Feature to Archive\n\n**Task**: Relocate feature folder to `_archive/` (NO git commits yet - those happen at the end).\n\n**Process**:\n1. Create archive summary file (from Step 1)\n2. Move entire feature folder to `_archive/`\n3. DEFER git commits until Step 8 (Final Commit & Push)\n\n**Output Section**:\n```\n## \ud83d\udce6 Archive Actions\n\n**Commands to Execute (NO GIT COMMITS YET)**:\n```bash\n# Navigate to project root\ncd /home/josiah/prompt-automation\n\n# Create archive directory if not exists\nmkdir -p docs/agentic_feature_implementation/_archive\n\n# Create archive summary\ncat > docs/agentic_feature_implementation/_archive/{YYYY-MM-DD}_feature_{NN}_summary.md << 'EOF'\n{...content from Step 1...}\nEOF\n\n# MOVE (not copy) feature folder to archive\nmv docs/agentic_feature_implementation/{NN}_{feature_name} \\\n   docs/agentic_feature_implementation/_archive/\n\n# VALIDATION: Verify source no longer exists (critical - prevents duplicate folders)\nif [ -d \"docs/agentic_feature_implementation/{NN}_{feature_name}\" ]; then\n  echo \"ERROR: Source folder still exists after move!\"\n  exit 1\nfi\n```\n\n**Verification**:\n- [ ] Archive summary created\n- [ ] Feature folder moved to `_archive/` (NOT copied - source must NOT exist)\n- [ ] Validation passed (source folder deleted)\n- [ ] Git commits DEFERRED to Step 8\n```\n\n---\n\n## Step 3: Update Documentation Indexes\n\n**Task**: Update all files that reference the feature list.\n\n**Process**:\n1. **README.md**:\n   - Find feature in list\n   - Change status from \"[ ]\" to \"[\u2705]\" or add \"\u2705 Archived\" marker\n   - Update completion count\n\n2. **FEATURE_INTEGRATION_CHECKLIST.md**:\n   - Mark feature as complete\n   - Update progress tracking\n\n3. **Feature dependency lists**:\n   - Find features that depend on this one\n   - Update their \"Dependencies\" status (mark as met)\n\n**Output Section**:\n```\n## \ud83d\udcdd Documentation Index Updates\n\n### File 1: docs/agentic_feature_implementation/README.md\n\n**Change**:\n```diff\n- | {NN}. {Title} | {Priority} | {Effort} | {Risk} | {Dependencies} |\n+ | \u2705 {NN}. {Title} | {Priority} | {Effort} | {Risk} | {Dependencies} | ARCHIVED |\n```\n\n**Also update**:\n- Progress counter: \"X of Y features complete\"\n\n---\n\n### File 2: docs/agentic_feature_implementation/FEATURE_INTEGRATION_CHECKLIST.md\n\n**Change**:\n```diff\n- [ ] Feature {NN}: {Title}\n+ [\u2705] Feature {NN}: {Title} - Archived {YYYY-MM-DD}\n```\n\n---\n\n### Files 3+: Dependent Feature Specs\n\n{For each feature that lists this one as a dependency:}\n\n**File**: `docs/agentic_feature_implementation/{MM}_{dep_feature}/feature_spec.md`\n\n**Change**:\n```diff\nDependencies:\n- Feature {NN} ({Title})\n+ Feature {NN} ({Title}) - \u2705 COMPLETE\n```\n\n---\n\n### Git Staging (NO COMMIT YET)\n```bash\n# Stage changes (commits happen in Step 8)\ngit add docs/agentic_feature_implementation/README.md \\\n        docs/agentic_feature_implementation/FEATURE_INTEGRATION_CHECKLIST.md \\\n        docs/agentic_feature_implementation/{dependent_features}\n```\n```\n\n---\n\n## Step 4: Update READMEs for Archived Feature\n\n**Task**: Update READMEs to reflect this feature's archival with proper hyperlinks. Assume READMEs are already well-structured; only add/update content for THIS feature.\n\n**Principle**: Main README is for setup and new user orientation only (CHANGELOG already tracks features). Feature README tracks all feature completions.\n\n**Process**:\n1. **Feature README** (`docs/agentic_feature_implementation/README.md`) - ALWAYS UPDATE:\n   - Update feature table entry to show \u2705 ARCHIVED status\n   - Ensure hyperlink to `_archive/{YYYY-MM-DD}_feature_{NN}/feature_spec.md` works\n   - This is the authoritative feature tracking location\n\n2. **Main README** (`README.md`) - UPDATE ONLY IF ABSOLUTELY NECESSARY:\n   - **Skip if**: Feature details already in CHANGELOG (most cases)\n   - **Update only if**: Feature fundamentally changes how new users set up or use the tool\n   - Examples requiring main README update:\n     * New installation method (e.g., Docker support)\n     * New quick-start command (e.g., `--validate` flag)\n     * Critical setup requirement (e.g., new API key needed)\n   - Examples NOT requiring main README update:\n     * Internal refactoring (GUI improvements, validation enhancements)\n     * New features tracked in CHANGELOG\n     * Performance improvements\n     * Bug fixes\n\n3. **Documentation Created by This Feature**:\n   - If implementation created new user-facing docs (e.g., `docs/VALIDATION_INTEGRATION.md`)\n   - Add hyperlink in Feature README, not main README (unless setup-critical)\n\n**Output Section**:\n```\n## \ud83d\udcdd README Updates for Feature {NN}\n\n### Analysis\n\n**Feature Type**: {User-facing | Internal/Infrastructure}\n**Setup Impact**: {Changes how new users install/setup | No setup changes}\n**Main README Update Required**: {YES - Reason | NO - Tracked in CHANGELOG only}\n\n---\n\n### Changes Required\n\n#### Feature README (`docs/agentic_feature_implementation/README.md`) - REQUIRED\n\n**Change**: Update feature table entry\n\n```diff\n- | {NN}. {Title} | {Priority} | {Effort} | {Risk} | {Dependencies} |\n+ | \u2705 {NN}. {Title} | {Priority} | {Effort} | {Risk} | {Dependencies} | [ARCHIVED](_archive/{YYYY-MM-DD}_feature_{NN}/) |\n```\n\n{If feature created new docs:}\n**Also add doc reference** (in appropriate section):\n```diff\n+ - [Feature {NN} Guide](path/to/guide.md): {1-sentence description}\n```\n\n---\n\n{If main README update needed (rare):}\n\n#### Main README (`README.md`) - CONDITIONAL\n\n**Update Required**: YES\n**Reason**: {Feature changes setup process | New quick-start command | Critical new requirement}\n\n**Section**: {Section Name} (e.g., \"## Installation\", \"## Quick Start\")\n\n**Add**:\n```diff\n+ {Minimal addition for new user orientation}\n```\n\n{If main README update NOT needed (most common):}\n\n#### Main README (`README.md`) - SKIPPED\n\n**Update Required**: NO\n**Reason**: Feature tracked in CHANGELOG v{version}. Main README reserved for setup/orientation only.\n\n---\n---\n\n### Commands (NO COMMIT YET)\n```bash\n# Stage feature README update (ALWAYS)\ngit add docs/agentic_feature_implementation/README.md\n\n{If main README update needed (rare):}\ngit add README.md\n\n{If new docs were created by implementation:}\ngit add docs/{new_guide}.md  # Already created during implementation\n```\n\n---\n\n### Summary\n\n**Feature README**: \u2705 Updated - Marked Feature {NN} as ARCHIVED with hyperlink\n\n{If main README updated:}\n**Main README**: \u2705 Updated - Added setup-critical information in {section}\n{If main README skipped:}\n**Main README**: \u23ed\ufe0f Skipped - Feature tracked in CHANGELOG only (no setup impact)\n\n{If new docs linked:}\n**Documentation**: Linked to `docs/{new_guide}.md` in feature README\n\n**Principle Applied**: Main README reserved for setup/orientation. Feature details tracked in CHANGELOG and feature README.\n```\n\n---\n\n## Step 5: Generate Context Summary for Next Feature\n\n**Task**: Create concise context doc for next feature to use.\n\n**Process**:\n1. Extract ONLY feature-relevant information:\n   - New APIs/functions added (signatures only)\n   - New modules/files (purpose only)\n   - Integration points changed\n   - Known issues affecting future work\n\n2. **EXCLUDE (Critical - Do Not Include)**:\n   - Process improvements (those go in Step 5 \u2192 AGENTS.md)\n   - Documentation updates (README, CHANGELOG, etc.)\n   - Test implementation details (test counts, pytest commands)\n   - TDD cycle details (RED/GREEN/REFACTOR steps)\n   - File size checks, coverage percentages, validation gates\n   - Git commands, commit messages\n   - Manual testing procedures\n   - State file operations\n\n3. **INCLUDE (Feature-Relevant Only)**:\n   - New public APIs (function signatures, parameters, return types)\n   - New modules/classes (purpose and location)\n   - Modified behaviors in existing functions (what changed, not how)\n   - Integration points affected (which components now interact)\n   - Known bugs/limitations discovered during implementation\n   - Dependencies unblocked (which features can now proceed)\n\n4. Keep ultra-concise (\u2264200 words)\n\n**Output Section**:\n```\n## \ud83d\uddc2\ufe0f Context Summary for Next Feature\n\n**File**: `docs/agentic_feature_implementation/_archive/{YYYY-MM-DD}_feature_{NN}_context.md`\n\n**Content**:\n```markdown\n# Feature {NN} Context ({YYYY-MM-DD})\n\n## New Capabilities\n\n**Module**: `src/prompt_automation/{module}/`\n- `{function}({params})`: {1-sentence purpose}\n- `{class}`: {1-sentence purpose}\n\n## Integration Points\n\n- **{Component}**: Now supports {capability} via `{function}`\n- **{Component}**: Modified to handle {scenario}\n\n## Known Issues Affecting Future Work\n\n{If any:}\n- Issue 1: {description + impact on future features}\n\n{If none:}\nNone.\n\n## Dependencies Unblocked\n\nFeatures now ready to implement:\n- Feature {MM}: {Title}\n- Feature {PP}: {Title}\n```\n```\n\n**Command (NO COMMIT YET)**:\n```bash\ncat > docs/agentic_feature_implementation/_archive/{YYYY-MM-DD}_feature_{NN}_context.md << 'EOF'\n{...content above...}\nEOF\n\n# Stage context file (commit happens in Step 8)\ngit add docs/agentic_feature_implementation/_archive/{YYYY-MM-DD}_feature_{NN}_context.md\n```\n```\n\n---\n\n## Step 6: Workflow Feedback Loop & AGENTS.md Updates\n\n**Task**: Identify process improvements and update governance documentation (AGENTS.md).\n\n**Process**:\n1. **Analyze workflow execution**:\n   - Were there any steps that were unclear in templates?\n   - Were there any missing templates/tools?\n   - Were there any repeated manual actions that could be automated?\n   - Were any constraints violated (file size, function size, TDD)?\n   - Were any approval gates missed?\n\n2. **Identify AGENTS.md gaps** (Priority):\n   - Are workflow policies documented (plan.md/tasks.md requirement)?\n   - Are checkpoint policies clear (branch decision, manual testing gate)?\n   - Are state file conventions documented?\n   - Are context summary rules explicit (\u2264200 words, feature-only)?\n   - Are README simplification policies documented?\n   - Are feature flag policies clear?\n\n3. **Identify other documentation gaps**:\n   - Were any patterns reused that should be in .github/copilot-instructions.md?\n   - Were any files referenced but not documented in CODEBASE_REFERENCE.md?\n\n4. **Suggest edits** (specific, actionable, file-by-file)\n\n**Output Section**:\n```\n## \ud83d\udd04 Workflow Feedback & Improvements\n\n### Process Improvements\n\n**Question 1**: Were there any edits to the workflow process you would make?\n\n{User answers in plain English}\n\n---\n\n**STOP HERE** - Wait for user input. If user provides feedback, continue to sub-steps below. If user says \"No\" or \"None\", skip to Step 6.\n\n---\n\n### Sub-Step 5a: Identify Documents to Update\n\n{Based on user feedback AND automated analysis, LLM identifies:}\n\n**Priority 1: AGENTS.md Updates**\n\n{Always check AGENTS.md for these policies - add if missing:}\n\n1. **AGENTS.md - Workflow Policies Section**\n   - Current Issue: {Missing or incomplete policy documentation}\n   - Proposed Change:\n     ```markdown\n     ## Automated Feature Workflow Policies\n     \n     ### Phase 1: Discovery & Planning\n     - Must create state file at `docs/agentic_feature_implementation/{NN}_{feature_name}/workflow_state_phase1.json`\n     - **Branch Decision Gate**: User must choose Option A (AI implementation) or Option B (meta-prompt)\n     - No implementation until approval recorded in state\n     \n     ### Phase 2a: Direct Implementation\n     - Must generate `plan.md` and `tasks.md` in feature folder before coding\n     - plan.md: Scope, approach, risk mitigations\n     - tasks.md: TDD tasks (RED/GREEN/REFACTOR cycle per task)\n     - **Manual Testing Gate**: Must test feature manually before proceeding to Phase 3\n     - State file: `{feature_id}_phase2a.json` with validation results\n     \n     ### Phase 3: Archival & Feedback\n     - **Context Summary Rules**:\n       - \u2264200 words, feature-relevant only\n       - INCLUDE: New APIs, modules, integration points, known issues, unblocked dependencies\n       - EXCLUDE: Process details, test counts, git commands, documentation updates\n     - **README Update Policy**:\n       - Assume READMEs are already well-structured at baseline conciseness\n       - Feature README: ALWAYS update feature table entry to show \u2705 ARCHIVED status\n       - Main README: Update ONLY if feature changes setup/installation for new users\n       - Skip main README if: Feature already tracked in CHANGELOG, no setup impact\n       - Rationale: CHANGELOG tracks features, main README is for setup/orientation only\n       - If feature created new docs: Link in feature README, not main README (unless setup-critical)\n       - Do NOT re-analyze or restructure entire READMEs each archival\n     - Must update AGENTS.md with lessons learned from workflow execution\n     ```\n   - Rationale: Ensures future workflows follow consistent governance\n\n2. **AGENTS.md - Other Policies** (if identified during workflow)\n   - Current Issue: {specific gap found}\n   - Proposed Change: {specific addition}\n   - Rationale: {why this improves consistency}\n\n**Priority 2: Other Documentation**\n\n3. **.github/copilot-instructions.md**\n   - Current Issue: {what's wrong/missing}\n   - Proposed Change: {specific edit}\n   - Rationale: {why this improves workflow}\n\n4. **{Other Document Path}**\n   - Current Issue: {what's wrong/missing}\n   - Proposed Change: {specific edit}\n   - Rationale: {why this improves workflow}\n\n...\n\n---\n\n**Question 2**: Do you approve these edits? (Y/n or specify changes)\n\n{User responds}\n\n---\n\n### Sub-Step 5b: Execute Documentation Updates\n\n{If approved, LLM shows exact diffs:}\n\n**Edit 1: {Document Path}**\n```diff\n{Show before/after with context}\n```\n\n**Edit 2: {Document Path}**\n```diff\n{Show before/after with context}\n```\n\n**Commands (NO COMMIT YET)**:\n```bash\n{Actual file edit commands or tool calls}\n\n# Stage workflow improvement changes (commit happens in Step 8)\ngit add {files}\n```\n\n---\n\n### Sub-Step 5c: Summary of Changes Made\n\n**Documentation Updates**:\n- Updated {file}: {change summary}\n- Updated {file}: {change summary}\n\n**Workflow Improvements**:\n- {Improvement 1}\n- {Improvement 2}\n\n{Note: These changes are NOT added to the feature context doc (Step 4)}\n```\n\n---\n\n## Step 7: Suggest Next Feature\n\n**Task**: Recommend the next feature to implement.\n\n**Process**:\n1. Scan `docs/agentic_feature_implementation/` for unarchived features\n2. Check dependencies (only suggest features with met dependencies)\n3. Consider priority and estimated effort\n4. Check for newly unblocked features (this feature was a dependency)\n\n**Output Section**:\n```\n## \ud83d\ude80 Next Feature Suggestion\n\n**Recommended Next**: Feature {MM}: {Title}\n\n**Rationale**:\n- Dependencies: {all met / list}\n- Priority: {HIGH/MEDIUM/LOW}\n- Estimated Effort: {X hours/days}\n- Risk: {HIGH/MEDIUM/LOW}\n- Reason: {why this feature next - e.g., \"Unblocks 3 other features\"}\n\n**Alternative Options**:\n1. Feature {PP}: {Title} ({reason})\n2. Feature {QQ}: {Title} ({reason})\n\n**Command to Start**:\n```bash\nprompt-automation --template 13023  # Phase 1: Discovery\n# Or specify feature directly:\nprompt-automation --template 13023 --var feature_context=\"{MM}_{feature_name}\"\n```\n```\n\n---\n\n## Step 8: Review Staged Changes\n\n**Task**: Show user all staged changes before committing.\n\n**Output Section**:\n```\n## \ud83d\udccb Staged Changes Review\n\n**All files staged for commit**:\n```bash\ngit status\n```\n\n**Summary of changes**:\n- Archive summary: `_archive/{YYYY-MM-DD}_feature_{NN}_summary.md`\n- Context summary: `_archive/{YYYY-MM-DD}_feature_{NN}_context.md`\n- Feature folder moved: `_archive/{NN}_{feature_name}/`\n- Documentation updated: README.md, FEATURE_INTEGRATION_CHECKLIST.md\n{If README changes for this feature:}\n- READMEs updated for Feature {NN}: README.md, docs/agentic_feature_implementation/README.md\n{If workflow improvements made:}\n- Workflow improvements: AGENTS.md, .github/copilot-instructions.md, etc.\n\n**Commits to be created**:\n1. `docs: archive Feature {NN} ({title}) after implementation`\n2. `docs: update indexes after archiving Feature {NN}`\n{If README updates:}\n3. `docs: update READMEs for archived Feature {NN}`\n{If context summary:}\n{N}. `docs: add context summary for Feature {NN}`\n{If workflow improvements:}\n{N}. `docs: workflow improvements based on Feature {NN} feedback`\n```\n\n---\n\n## Step 8.5: Cleanup Workspace Index\n\n**Task**: Delete the workspace index file before final commit.\n\n**Why**: The index becomes stale quickly. Each feature iteration rebuilds it fresh in Phase 1.\n\n**Command**:\n```bash\n# Remove workspace index (will be rebuilt in next Phase 1)\nrm -f .prompt-automation-index.json\n\n# Stage the deletion (if index was tracked)\ngit rm --cached .prompt-automation-index.json 2>/dev/null || true\n```\n\n**Output**:\n```\n## \ud83e\uddf9 Workspace Index Cleanup\n\n**Action**: Deleted `.prompt-automation-index.json`\n**Reason**: Index becomes stale; will rebuild in next Phase 1\n**Status**: \u2705 Workspace clean\n```\n\n**Note**: If `.prompt-automation-index.json` is in `.gitignore`, the git rm command will fail silently (expected).\n\n---\n\n## Step 9: Commit & Push (USER APPROVAL REQUIRED)\n\n**Task**: Get user approval, then commit and push all changes.\n\n**\u23f8\ufe0f CHECKPOINT: User Approval Gate**\n\n**Question**: Ready to commit and push all changes? (Y/n)\n\n{Wait for user response}\n\n---\n\n**If user approves, execute these commands**:\n\n```bash\n# Commit 1: Archive feature\ngit commit -m \"docs: archive Feature {NN} ({title}) after implementation\n\nImplementation complete:\n- {summary line 1}\n- {summary line 2}\n- Tests: {count} passed, coverage: {XX}%\n\nCloses #{issue_number if exists}\"\n\n# Commit 2: Update indexes (if changes made)\ngit add docs/agentic_feature_implementation/README.md \\\n        docs/agentic_feature_implementation/FEATURE_INTEGRATION_CHECKLIST.md\ngit commit -m \"docs: update indexes after archiving Feature {NN}\"\n\n# Commit 3: README updates (if changes made)\ngit add README.md \\\n        docs/agentic_feature_implementation/README.md\ngit commit -m \"docs: update READMEs for archived Feature {NN}\"\n\n# Commit 4: Context summary (if changes made)\ngit add docs/agentic_feature_implementation/_archive/{YYYY-MM-DD}_feature_{NN}_context.md\ngit commit -m \"docs: add context summary for Feature {NN}\"\n\n{If workflow improvements made:}\n# Commit 5: Workflow improvements\ngit add {workflow_files}\ngit commit -m \"docs: workflow improvements based on Feature {NN} feedback\"\n\n# Push all commits to remote\ngit push origin feature/{NN}-{feature-name}\n```\n\n**Output Section**:\n```\n## \u2705 Changes Committed & Pushed\n\n**Commits created**:\n- `{hash1}`: Archive Feature {NN}\n- `{hash2}`: Update indexes\n- `{hash3}`: Update READMEs for archived Feature {NN}\n- `{hash4}`: Add context summary\n{If applicable:}\n- `{hash5}`: Workflow improvements\n\n**Remote branch**: `feature/{NN}-{feature-name}`\n**Status**: All changes pushed successfully\n\n**Next steps**:\n1. Create PR to merge into main (or continue to next feature)\n2. Begin Phase 1 for next feature (see Step 9 suggestion)\n```\n\n---\n\n## Step 9: Final Summary\n\n**Task**: Recap all actions taken.\n\n**Output Section**:\n```\n## \u2705 Phase 3 Complete - Feature Archived\n\n### Actions Completed\n- [\u2705] Archive summary created\n- [\u2705] Feature folder moved to `_archive/`\n- [\u2705] Documentation indexes updated (README, CHECKLIST)\n- [\u2705] Context summary generated for next feature\n- [{\u2705/\u23ed\ufe0f}] Workflow feedback incorporated {if provided}\n- [\u2705] User approved commits & push\n- [\u2705] All changes committed and pushed to remote\n- [\u2705] Next feature suggested\n\n### Git Commits\n- `{hash1}`: Archive Feature {NN}\n- `{hash2}`: Update indexes after archiving\n- `{hash3}`: Update READMEs for archived Feature {NN}\n- `{hash4}`: Add context summary\n{If feedback provided:}\n- `{hash5}`: Workflow improvements\n\n### Feature {NN} Status\n**Status**: \u2705 ARCHIVED\n**Archived**: {YYYY-MM-DD}\n**Location**: `docs/agentic_feature_implementation/_archive/{NN}_{feature_name}/`\n**Context**: `docs/agentic_feature_implementation/_archive/{YYYY-MM-DD}_feature_{NN}_context.md`\n**Remote Branch**: `feature/{NN}-{feature-name}` (pushed)\n\n### Workflow Complete\nFeature {NN} ({Title}) is now complete, archived, and pushed. Ready to begin Feature {MM}.\n\n**Next Command**:\n```bash\nprompt-automation --template 13023  # Start Phase 1 for next feature\n```\n```\n\n---\n\n# Quality Checks (Self-Validation)\n\nBefore completing, verify:\n- [ ] Phase 2 state loaded and validated\n- [ ] Manual test result confirmed (PASSED or SKIPPED with reason)\n- [ ] Archive summary is concise (\u2264500 words)\n- [ ] Feature folder moved to `_archive/`\n- [ ] All documentation indexes updated\n- [ ] Context summary is feature-focused (excludes process changes)\n- [ ] Workflow feedback loop executed (if user provided input)\n- [ ] Next feature suggested with rationale\n- [ ] Staged changes reviewed\n- [ ] Workspace index deleted (cleanup before commit)\n- [ ] User approved commits & push\n- [ ] All changes committed and pushed to remote\n\n# Output Format\n\n**For MAJOR Features** - Present all 11 steps in order:\n0. Phase 2 State Loaded\n1. Archive Summary\n2. Move to Archive (with commands - NO COMMITS)\n3. Documentation Index Updates (with diffs - NO COMMITS)\n4. Simplify READMEs & Create Hyperlinked Docs (with diffs - NO COMMITS)\n5. Context Summary for Next Feature (NO COMMITS)\n6. Workflow Feedback Loop (interactive - NO COMMITS if edits made)\n7. Next Feature Suggestion\n8. Review Staged Changes\n8.5. Cleanup Workspace Index (delete .prompt-automation-index.json)\n9. Commit & Push (USER APPROVAL REQUIRED)\n10. Final Summary\n\n**For MINOR Features** - Present simplified steps:\n0. Phase 2 State Loaded (with classification detection)\n1-MINOR. Update Stub with Completion Marker\n2-MINOR. Update CHANGELOG.md (optional)\n3-MINOR. Commit & Push (USER APPROVAL REQUIRED)\n4-MINOR. Final Summary\n\nUse markdown formatting with clear headers, code blocks, diffs, and checkboxes.\n\n# Evaluation Criteria\n\n**For MAJOR Features**:\n- pass_if(phase2_state_loaded == true)\n- pass_if(manual_test_validated == true)\n- pass_if(archive_summary_created == true)\n- pass_if(feature_moved_to_archive == true)\n- pass_if(documentation_indexes_updated == true)\n- pass_if(context_summary_generated == true)\n- pass_if(next_feature_suggested == true)\n\n**For MINOR Features**:\n- pass_if(phase2_state_loaded == true)\n- pass_if(manual_test_validated == true)\n- pass_if(stub_updated_with_completion == true)\n- pass_if(changelog_updated == true OR skipped_with_reason)\n- pass_if(feature_stays_in_minor_features == true)\n- pass_if(no_archival_attempted == true)",
  "description": "This template archives completed features and captures implementation learnings to help you preserve context and improve future development. It moves feature folders to _archive/, creates implementation summaries (\u2264500 words), updates CHANGELOG.md and README.md, and suggests next features from remaining work. Output: archived feature folder with summary docs, updated project documentation, and next feature recommendation. Use after manual testing passes (Phase 3 of agentic workflow).",
  "trigger": ":feature_ar",
  "variables": [
    {
      "name": "phase2_state",
      "label": "Phase 2 state (JSON from docs/agentic_feature_implementation/{NN}_{feature_name}/workflow_state_phase2a.json or phase2b completion status). If empty, will load from feature folder.",
      "multiline": true
    },
    {
      "name": "manual_test_result",
      "label": "Manual testing result (PASSED/FAILED/SKIPPED with notes). Required for Phase 2a implementations.",
      "default": "PASSED - All manual tests successful",
      "multiline": true
    }
  ]
}