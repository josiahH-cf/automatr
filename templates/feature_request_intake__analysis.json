{
  "name": "Feature Request Intake & Analysis",
  "content": "# Feature Request Intake & Analysis System\n\n# \u26a0\ufe0f CONTEXT INSTRUCTIONS FOR AI AGENT\n\n**CRITICAL**: This is a STANDALONE template for feature request analysis. Do NOT search @workspace until Step 2.\n\nYou are a **Feature Architect** analyzing incoming feature requests and preparing them for implementation. Your job is to:\n1. Parse and understand feature requests (1 or many)\n2. Analyze existing roadmap for conflicts/dependencies/duplicates\n3. Suggest optimal placement in feature hierarchy\n4. Generate complete feature specs ready for Phase 1 workflow\n5. Prioritize and sequence features intelligently\n\n**Philosophy**: Features should be **small, focused, composable**. One feature = one capability. Break large requests into multiple features if needed.\n\n---\n\n# Input: Feature Requests\n\n{{feature_requests}}\n\n# Project Context\n\n{{project_context}}\n\n---\n\n# Step 0: Rebuild Workspace Index\n\n**ALWAYS rebuild the workspace index first for accurate analysis.**\n\n```bash\nprompt-automation --index-workspace\n```\n\nThis ensures you have up-to-date file locations, function signatures, and codebase structure.\n\n---\n\n# Step 1: Parse Feature Requests\n\n**Task**: Break down the input into individual, atomic feature requests.\n\n**Process**:\n1. Read `{{feature_requests}}`\n2. Identify distinct features (look for separators, numbering, clear boundaries)\n3. For each feature, extract:\n   - **Core capability** (what does it do?)\n   - **User benefit** (why is it needed?)\n   - **Rough scope** (files/modules affected)\n   - **Dependencies** (what must exist first?)\n\n**Output Section**:\n```markdown\n## \ud83d\udccb Parsed Feature Requests\n\nFound {N} feature request(s):\n\n### Request 1: {Short Title}\n- **Capability**: {What it does}\n- **Benefit**: {Why it's needed}\n- **Rough Scope**: {Estimated complexity - Small/Medium/Large}\n- **Apparent Dependencies**: {List features that must exist first, or 'None'}\n\n### Request 2: {Short Title}\n...\n```\n\n**\u23f8\ufe0f CHECKPOINT**: Show parsed requests and ask: \"Did I understand correctly? (Y/n)\"\n\n---\n\n# Step 2: Analyze Existing Roadmap\n\n**Task**: Search for existing features, detect conflicts, find dependencies.\n\n**NOW search @workspace**:\n1. List all feature folders in `docs/agentic_feature_implementation/`\n2. Exclude `_archive/` and `deferred_features/`\n3. For each existing feature:\n   - Read `feature_spec.md`\n   - Extract: title, purpose, dependencies, files affected\n4. Read `FEATURE_INTEGRATION_CHECKLIST.md` for current feature list\n\n**Use Workspace Context Gatherer** for deep analysis:\n```python\nfrom prompt_automation.workspace.context_gatherer import ContextGatherer\nfrom pathlib import Path\n\ngatherer = ContextGatherer(Path.cwd())\nfor request in parsed_requests:\n    context = gatherer.gather_for_feature(request.title)\n    # Analyze: existing code, tests, integration points\n```\n\n**Conflict Detection**:\n- **Duplicate**: Does an existing feature already do this?\n- **Overlap**: Would this feature compete/conflict with planned features?\n- **Dependency**: Does this require features not yet implemented?\n- **Supersede**: Does this replace/deprecate existing features?\n\n**Output Section**:\n```markdown\n## \ud83d\udd0d Roadmap Analysis\n\n**Existing Features** ({N} active, {M} archived):\n- 05: Validation Runner (LOW priority, no deps) - Active\n- 06: Feature Pipeline Orchestrator (HIGH priority, depends on 05) - Active\n- ...\n\n**Conflict Analysis**:\n\n### Request 1: {Title}\n- \u2705 **No conflicts** - Novel capability\n- \u26a0\ufe0f **Overlap with Feature 07** - Both handle code generation (suggest merge or split)\n- \u274c **Duplicate of Feature 12** - Already implements this (suggest skip or enhance)\n- \ud83d\udd17 **Depends on Feature 03** - Requires Knowledge Base\n\n### Request 2: {Title}\n...\n```\n\n---\n\n# Step 3: Suggest Placement & Numbering\n\n**Task**: Determine optimal location in feature hierarchy.\n\n**Placement Rules**:\n1. **Foundational infrastructure** (config, caching, performance) \u2192 Lower numbers (00-04)\n2. **Core workflow** (validation, orchestration, agents) \u2192 Mid numbers (05-12)\n3. **Advanced features** (GUI, analytics, integrations) \u2192 Higher numbers (13-22)\n4. **Deferred** (uncertain value, low priority, blocked) \u2192 `deferred_features/`\n\n**Numbering Logic**:\n- If feature has no deps: suggest next available number in its category\n- If feature has deps: place AFTER highest dependency number\n- If feature unlocks many others: suggest renumbering to move earlier\n\n**Folder Naming**:\n- Format: `{NN}_{snake_case_name}/`\n- Example: `23_api_rate_limiter/`\n\n**Renumbering Analysis**:\n- Check if new foundational features should move existing features higher\n- Example: New caching system (03) means current Feature 05+ should shift to 06+\n\n**Output Section**:\n```markdown\n## \ud83d\udccd Placement Analysis\n\n### Request 1: {Title}\n- **Suggested Number**: 23\n- **Category**: Advanced Feature\n- **Rationale**: Depends on Feature 20 (Performance Manager), no blockers\n- **Folder**: `23_{snake_case_name}/`\n- **Renumbering Needed**: No\n\n### Request 2: {Title}\n- **Suggested Number**: 03\n- **Category**: Foundational Infrastructure\n- **Rationale**: No dependencies, enables Features 05-22\n- **Folder**: `03_cache_manager/`\n- **Renumbering Needed**: \u26a0\ufe0f YES - Shifts current 03-22 \u2192 04-23\n\n**Renumbering Plan** (if needed):\n```bash\n# Current 03 becomes 04\ngit mv docs/agentic_feature_implementation/03_knowledge_base/ \\\n        docs/agentic_feature_implementation/04_knowledge_base/\n# Update all references in:\n# - FEATURE_INTEGRATION_CHECKLIST.md\n# - README.md\n# - Dependency lists in other feature_spec.md files\n```\n```\n\n---\n\n# Step 4: Generate Feature Specs\n\n**Task**: Create complete `feature_spec.md` for each request.\n\n**Spec Template** (use existing features as reference):\n\n```markdown\n# Feature: {Title}\n\n**Feature ID**: `{kebab-case-id}`\n**Priority**: {HIGH / MEDIUM / LOW}\n**Estimated Effort**: {X} days\n**Risk Level**: {LOW / MEDIUM / HIGH}\n**Dependencies**: {List feature IDs or 'None'}\n\n---\n\n## Overview\n\n{2-3 paragraph description of what this feature does, why it's needed, and how it fits into the project}\n\n---\n\n## Critical Questions & Risks\n\n### \u2753 Open Questions\n\n**Q1: {Question}**\n- **Answer**: {Proposed answer or 'TBD'}\n- **Reasoning**: {Why this answer}\n\n### \u26a0\ufe0f Implementation Risks\n\n| Risk | Severity | Mitigation |\n|------|----------|------------|\n| {Risk description} | {LOW/MEDIUM/HIGH} | {How to address} |\n\n---\n\n## Requirements\n\n### Functional Requirements\n\n1. **{Requirement Name}**\n   - Description\n   - Acceptance criteria\n\n### Non-Functional Requirements\n\n- **Performance**: {Targets}\n- **Reliability**: {Targets}\n- **Observability**: {What to log/metric}\n\n---\n\n## Architecture\n\n### File Structure\n\n```\nsrc/{module}/\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 {main_module}.py  (~XXX LOC)\n\u251c\u2500\u2500 {helper1}.py      (~XXX LOC)\n\u2514\u2500\u2500 {helper2}.py      (~XXX LOC)\n```\n\n### Class Design\n\n```python\nclass {MainClass}:\n    \"\"\"Purpose.\"\"\"\n    \n    def main_method(self) -> ReturnType:\n        \"\"\"Description.\"\"\"\n```\n\n---\n\n## Implementation Plan\n\n### Phase 1: {Phase Name}\n\n**Code**: {Pseudocode or key snippets}\n\n**Tests**: {Test strategy}\n\n---\n\n## Acceptance Criteria\n\n- [ ] {Criterion 1}\n- [ ] {Criterion 2}\n- [ ] All tests pass\n- [ ] Coverage \u226585%\n\n---\n\n## Future Enhancements (Out of Scope)\n\n1. {Enhancement}\n\n---\n\n## Migration Notes\n\n{How to migrate from old system, or 'N/A - new component'}\n\n---\n\n## Rollback Plan\n\n{How to disable/remove if it causes issues}\n```\n\n**Gather Details**:\n- Use workspace context to find similar features (copy their structure)\n- Check AGENTS.md for constraints (\u2264400 LOC/file, \u226475 LOC/function)\n- Review project patterns (config system, feature flags, testing approach)\n\n**Output Section**:\n```markdown\n## \ud83d\udcc4 Generated Feature Specs\n\n### Feature {NN}: {Title}\n\n**File**: `docs/agentic_feature_implementation/{NN}_{name}/feature_spec.md`\n\n```markdown\n{...Complete spec content...}\n```\n\n---\n\n{Repeat for each feature}\n```\n\n---\n\n# Step 5: Prioritization & Sequencing\n\n**Task**: Generate a prioritized implementation order.\n\n**Prioritization Factors**:\n1. **Dependency chain**: Foundational features first\n2. **Business value**: High-impact features prioritized\n3. **Risk**: Low-risk features can be done early for momentum\n4. **Effort**: Mix quick wins with larger features\n5. **Blocking**: Features that unblock many others go first\n\n**Sequencing Algorithm**:\n```\n1. Build dependency graph\n2. Topological sort (dependencies first)\n3. Within each \"tier\" (features with same dependency depth):\n   - Sort by priority (HIGH > MEDIUM > LOW)\n   - Then by effort (Small > Medium > Large for momentum)\n4. Identify critical path (longest chain)\n```\n\n**Output Section**:\n```markdown\n## \ud83c\udfaf Prioritization & Sequencing\n\n### Priority Matrix\n\n| Feature | Number | Priority | Effort | Risk | Dependencies | Blocks | Sequence |\n|---------|--------|----------|--------|------|--------------|--------|----------|\n| Cache Manager | 03 | HIGH | 2d | LOW | None | 05,06,19,20 | **1st** |\n| API Rate Limiter | 23 | MEDIUM | 1d | LOW | 03,20 | None | 5th |\n| {Feature} | {N} | {H/M/L} | {Xd} | {L/M/H} | {IDs} | {IDs} | {Order} |\n\n### Recommended Implementation Order\n\n**Sprint 1** (Foundational):\n1. Feature 03: Cache Manager - Unblocks performance features\n2. Feature 04: Config Validator - Reduces risk for all features\n\n**Sprint 2** (Core Workflow):\n3. Feature 05: Validation Runner - Already approved, no deps\n4. Feature 06: Pipeline Orchestrator - Depends on 05\n\n**Sprint 3** (Advanced):\n5. Feature 23: API Rate Limiter - Depends on 03, 20\n6. Feature 24: {New Feature} - Depends on 23\n\n**Deferred** (Low priority or blocked):\n- Feature Request X: {Title} - Reason: Unclear ROI, needs refinement\n\n### Critical Path\n\n**Longest Chain**: 03 \u2192 20 \u2192 23 \u2192 24 (4 features, ~8 days)\n\n**Parallel Tracks**:\n- Track A: 03 \u2192 19 \u2192 21 (Caching \u2192 Performance \u2192 Analytics)\n- Track B: 05 \u2192 06 \u2192 10 (Validation \u2192 Pipeline \u2192 PR Automation)\n- Track C: 04 \u2192 07 \u2192 08 (Config \u2192 Agent \u2192 Test Gen)\n\n**Recommendation**: Start Track B (already approved) while preparing Track A (higher value).\n```\n\n---\n\n# Step 6: Detect Deferrals\n\n**Task**: Identify features that should be deferred.\n\n**Deferral Criteria**:\n- **Unclear scope**: Needs more research/design\n- **Low priority**: Nice-to-have, not critical\n- **Blocked**: Depends on external factors (API availability, design decision)\n- **Risky**: High complexity, uncertain approach\n- **Out of scope**: Doesn't fit project goals\n\n**Deferred Location**: `docs/agentic_feature_implementation/deferred_features/{name}/`\n\n**Deferred Spec Format**:\n```markdown\n# Deferred Feature: {Title}\n\n**Deferred Date**: {ISO date}\n**Reason**: {Why deferred}\n**Reconsider When**: {Trigger - e.g., 'After Feature 20 complete', 'When API v2 releases'}\n\n## Original Request\n\n{Copy of original request}\n\n## Why Deferred\n\n{Detailed reasoning}\n\n## Prerequisites for Activation\n\n- [ ] {Condition 1}\n- [ ] {Condition 2}\n```\n\n**Output Section**:\n```markdown\n## \ud83d\udeab Deferral Analysis\n\n**Features to Defer** ({N}):\n\n### 1. {Title}\n- **Reason**: Unclear scope - needs design workshop\n- **Reconsider When**: After Feature 15 (Template Management) complete\n- **Location**: `deferred_features/advanced_template_inheritance/`\n\n### 2. {Title}\n- **Reason**: Low priority - minimal user impact\n- **Reconsider When**: Q2 2026 roadmap planning\n- **Location**: `deferred_features/custom_theme_editor/`\n```\n\n---\n\n# Step 7: Generate Approval Report\n\n**Task**: Summarize everything for stakeholder approval.\n\n**Output Section**:\n```markdown\n## \u2705 Approval Report\n\n### Summary\n\n**Total Requests**: {N}\n**Accepted**: {M} features\n**Deferred**: {K} features\n**Merged**: {X} requests combined into {Y} features\n\n### Accepted Features\n\n| # | Feature | Priority | Effort | Sequence | Dependencies |\n|---|---------|----------|--------|----------|--------------|\n| 03 | Cache Manager | HIGH | 2d | 1st | None |\n| 23 | API Rate Limiter | MEDIUM | 1d | 5th | 03, 20 |\n| ... | ... | ... | ... | ... | ... |\n\n### Deferred Features\n\n| Feature | Reason | Reconsider When |\n|---------|--------|-----------------|\n| Advanced Template Inheritance | Unclear scope | After Feature 15 |\n| Custom Theme Editor | Low priority | Q2 2026 planning |\n\n### Renumbering Required\n\n{If yes, show git mv commands}\n{If no, state 'No renumbering needed'}\n\n### Implementation Estimate\n\n- **Total Effort**: {X} days ({Y} weeks at 1 feature/day)\n- **Earliest Start**: Feature {lowest number}\n- **Critical Path**: {X} days\n- **Parallel Capacity**: {Y} independent tracks\n\n### Risks & Mitigations\n\n| Risk | Features Affected | Mitigation |\n|------|-------------------|------------|\n| {Risk} | {IDs} | {How to address} |\n\n---\n\n**Approval Options**:\n\n1. **Approve All** - Create all feature folders and specs\n2. **Approve Subset** - Select specific features (e.g., 'Approve 03, 23 only')\n3. **Request Changes** - Modify specs or priorities\n4. **Defer All** - Move to deferred_features/ for later review\n\n**Your decision**: {1, 2, 3, or 4}\n```\n\n**\u23f8\ufe0f STOP HERE**: Wait for approval before Step 8.\n\n---\n\n# Step 8: Create Feature Folders & Specs\n\n**Task**: Write approved features to disk.\n\n**Process** (for each approved feature):\n\n1. **Create folder**:\n```bash\nmkdir -p docs/agentic_feature_implementation/{NN}_{name}\n```\n\n2. **Write feature_spec.md**:\n```bash\ncat > docs/agentic_feature_implementation/{NN}_{name}/feature_spec.md << 'EOF'\n{...generated spec from Step 4...}\nEOF\n```\n\n3. **Create deferred specs** (if any):\n```bash\nmkdir -p docs/agentic_feature_implementation/deferred_features/{name}\ncat > docs/agentic_feature_implementation/deferred_features/{name}/deferred_spec.md << 'EOF'\n{...deferred spec from Step 6...}\nEOF\n```\n\n4. **Update FEATURE_INTEGRATION_CHECKLIST.md**:\n- Add new features to the list\n- Update numbering if needed\n- Mark dependencies\n\n5. **Update README.md** (if major roadmap change)\n\n6. **Perform renumbering** (if needed):\n```bash\n# Execute git mv commands from Step 3\n# Update all cross-references\n```\n\n**Output Section**:\n```markdown\n## \ud83d\udcbe Feature Specs Created\n\n**Created {N} feature folders:**\n\n\u2705 `docs/agentic_feature_implementation/03_cache_manager/feature_spec.md`\n\u2705 `docs/agentic_feature_implementation/23_api_rate_limiter/feature_spec.md`\n...\n\n**Deferred {M} features:**\n\n\ud83d\udcc1 `docs/agentic_feature_implementation/deferred_features/advanced_template_inheritance/`\n\ud83d\udcc1 `docs/agentic_feature_implementation/deferred_features/custom_theme_editor/`\n\n**Updated documentation:**\n\n\u2705 `FEATURE_INTEGRATION_CHECKLIST.md` - Added {N} features\n\u2705 `README.md` - Updated roadmap section\n{If renumbered: \u2705 Renumbered Features 03-22 \u2192 04-23}\n\n---\n\n## \ud83d\ude80 Next Steps\n\nYour features are ready! To start implementation:\n\n**For the first feature (Feature {NN}):**\n```bash\nprompt-automation --template 13023 --var 'feature_context={NN}_{name}'\n```\n\nOr in Copilot Chat:\n\"Let's kick off the next feature: {NN}\"\n\n**Implementation Order**:\n1. Feature {NN1}: {Title} - {Effort}\n2. Feature {NN2}: {Title} - {Effort}\n3. ...\n\n**Total Timeline**: ~{X} weeks (sequential) or ~{Y} weeks (with parallelization)\n```\n\n---\n\n# Quality Checklist\n\nBefore finalizing, verify:\n- [ ] All feature requests parsed correctly\n- [ ] No duplicate features (checked against existing roadmap)\n- [ ] Dependencies are valid (no circular deps)\n- [ ] Numbering follows logical sequence (deps before dependents)\n- [ ] Each spec has measurable acceptance criteria\n- [ ] Deferred features have clear reactivation triggers\n- [ ] Documentation updated (checklist, README)\n- [ ] User approved the plan before writing files\n\n---\n\n# Project Agnosticism Notes\n\n**For use in other projects**:\n\n1. **Replace paths**:\n   - `docs/agentic_feature_implementation/` \u2192 your feature folder\n   - `FEATURE_INTEGRATION_CHECKLIST.md` \u2192 your roadmap doc\n\n2. **Adapt constraints**:\n   - Read project's AGENTS.md or CONTRIBUTING.md for size limits, TDD rules\n   - Check for feature flag conventions\n\n3. **Customize spec template**:\n   - Match your project's feature spec format\n   - Include project-specific sections (security, compliance, etc.)\n\n4. **Adjust indexer usage**:\n   - If no indexer: use `grep`, `find`, or manual search\n   - If different indexer: adapt workspace context gathering\n\n5. **Prioritization weights**:\n   - Adjust factors for your team (security > speed, or cost > features)\n\n6. **Numbering scheme**:\n   - Some projects use YYYYMMDD format, semantic versioning, etc.\n   - Adapt to your convention",
  "description": "This template performs batch analysis of feature requests (one or multiple) to help you transform rough ideas into prioritized, ready-to-implement feature specifications. It analyzes conflicts, suggests optimal placement in your roadmap, and generates complete feature specs with dependency sequencing. Output: priority matrix, implementation order (Sprint 1/2/3 groupings), feature folders with specs, and deferred items with reactivation triggers. Use during quarterly planning, batch processing, or when unsure where features belong in your hierarchy.",
  "trigger": ":feature_re",
  "variables": [
    {
      "name": "feature_requests",
      "label": "Feature request(s) - one or multiple. Describe what you want to add (can be rough notes, bullet points, or detailed specs).",
      "multiline": true
    },
    {
      "name": "project_context",
      "label": "Optional: Project-specific context (technology stack, constraints, goals). Leave empty for prompt-automation defaults.",
      "multiline": true
    }
  ]
}